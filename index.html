<!DOCTYPE html>
<html>
	<head>
		<!--
		COPYRIGHT (C) D. LETTIER 2012.
		HTTP://WWW.LETTIER.COM/
		IF YOU NEED A WEB DEVELOPER, DON'T HESITATE TO ASK.
		-->
		<title>POiNG | LETTiER</title>
		<meta charset="UTF-8"> 
		<style>
			html
			{
				min-height: 100%;
			}
			body
			{
				background: #000000;
				background: no-repeat 50% 300px, -moz-radial-gradient(center, circle farthest-corner, #223627 0%, #121212 100%);
				background: no-repeat 50% 300px, -ms-radial-gradient(center, circle farthest-corner, #223627 0%, #121212 100%);
				background: no-repeat 50% 300px, -o-radial-gradient(center, circle farthest-corner, #223627 0%, #121212 100%);
				background: no-repeat 50% 300px, -webkit-gradient(radial, center center, 0, center center, 497, color-stop(0, #223627), color-stop(1, #121212));
				background: no-repeat 50% 300px, -webkit-radial-gradient(center, circle farthest-corner, #223627 0%, #121212 100%);
				background: no-repeat 50% 300px, radial-gradient(circle farthest-corner at center, #223627 0%, #121212 100%);
				margin: 0px;
				padding: 0px;
				overflow: hidden;
			}
			#lettier
			{
				border: 0px;
				position: absolute;
				left: 0px;
				top: 0px;
			}
			#debug
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 200px;
				height: 200px;
				border: 0px;
				margin: 0px;
				padding: 0px;
				color: #FFFFFF;
			}
			#logo
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 400px;
				height: 75px;
				border: 0px solid #FFFFFF;				
				margin: 0px;
				padding: 0px;
				padding-right: 50px;
				padding-left: 55px;
				color: #ffffb2;
				font-size: 60pt;
				text-align: center;
				z-index: 3;
			}
			#score
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 500px;
				height: 75px;
				border: 2px solid #FFFFFF;
				margin: 0px;
				background: #222222;
				padding: 0px;
				padding-right: 50px;
				padding-left: 50px;
				color: #FFFFFF;
				font-size: 50pt;
				text-align: center;
				border-radius: 75px;
				z-index: 2;
			}
			#play1
			{
				color: #99ff33;
			}
			#play2
			{
				color: #ff3333;
			}
			#pad1
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 25px;
				height: 100px;
				border: 0px;
				border-right: 4px solid #99ff33;
				margin: 0px;
				padding: 0px;
				background: #FFFFFF;
				border-radius: 75px;
				-moz-border-radius:75px;
				-khtml-border-radius: 75px;
				-webkit-border-radius:75px;
			}
			#pad11
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 100px;
				height: 25px;
				border: 0px;
				border-top: 4px solid #99ff33;
				margin: 0px;
				padding: 0px;
				background: #FFFFFF;
				border-radius: 75px;
				-moz-border-radius:75px;
				-khtml-border-radius: 75px;
				-webkit-border-radius:75px;
			}
			#pad12
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 100px;
				height: 25px;
				border: 0px;
				border-bottom: 4px solid #99ff33;
				margin: 0px;
				padding: 0px;
				background: #FFFFFF;
				border-radius: 75px;
				-moz-border-radius:75px;
				-khtml-border-radius: 75px;
				-webkit-border-radius:75px;
			}
			#pad2
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 25px;
				height: 100px;
				border: 0px;
				border-left: 4px solid #ff3333;
				margin: 0px;
				padding: 0px;
				background: #FFFFFF;
				border-radius: 75px;
				-moz-border-radius:75px;
				-khtml-border-radius: 75px;
				-webkit-border-radius:75px;
			}
			#pad21
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 100px;
				height: 25px;
				border: 0px;
				border-top: 4px solid #ff3333;
				margin: 0px;
				padding: 0px;
				background: #FFFFFF;
				border-radius: 75px;
				-moz-border-radius:75px;
				-khtml-border-radius: 75px;
				-webkit-border-radius:75px;
			}
			#pad22
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 100px;
				height: 25px;
				border: 0px;
				border-bottom: 4px solid #ff3333;
				margin: 0px;
				padding: 0px;
				background: #FFFFFF;
				border-radius: 75px;
				-moz-border-radius:75px;
				-khtml-border-radius: 75px;
				-webkit-border-radius:75px;
			}
			#net
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 0px;
				height: 0px;
				border: 1px dashed #FFFFFF;
				margin: 0px;
				padding: 0px;
				background: #FFFFFF;
				border-radius: 75px;
				-moz-border-radius:75px;
				-khtml-border-radius: 75px;
				-webkit-border-radius:75px;
			}
			#ball
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 25px;
				height: 25px;
				border: 2px solid #FFFFFF;
				margin: 0px;
				padding: 0px;
				background: #ffffb2;
				border-radius: 75px;
				-moz-border-radius:75px;
				-khtml-border-radius: 75px;
				-webkit-border-radius:75px;
				z-index: 5;
			}
		</style>
	</head>
	<body>
		<div id="lettier"><img src="logo.png" width="800" height="800" alt="LETTiER"></div>
		<div id="debug">&nbsp;</div>
		<div id="logo">POiNG</div>
		<div id="score"><div id="play1" style="float:left">0</div> <div id="play2" style="float:right">0</div></div>
		<div id="pad1">&nbsp;</div>
		<div id="pad11">&nbsp;</div>
		<div id="pad12">&nbsp;</div>
		<div id="pad2">&nbsp;</div>
		<div id="pad21">&nbsp;</div>
		<div id="pad22">&nbsp;</div>
		<div  id="net">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;</div>
		<div id="ball">&nbsp;</div>
		<script type="text/javascript">
		
				
			(function() {
				var lastTime = 0;
				var vendors = ['ms', 'moz', 'webkit', 'o'];
				for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
					window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
					window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame']
					|| window[vendors[x]+'CancelRequestAnimationFrame'];
				}

				if (!window.requestAnimationFrame)
				window.requestAnimationFrame = function(callback, element) {
					var currTime = new Date().getTime();
					var timeToCall = Math.max(0, 16 - (currTime - lastTime));
					var id = window.setTimeout(function() { callback(currTime + timeToCall); },
					timeToCall);
					lastTime = currTime + timeToCall;
					return id;
				};

				if (!window.cancelAnimationFrame)
				window.cancelAnimationFrame = function(id) {
					clearTimeout(id);
				};
			}());
			
					
		
			var wwidth  = window.innerWidth;
			var wheight = window.innerHeight;
			
			var debug = document.getElementById( "debug" );
			var lettier = document.getElementById( "lettier" );			
			var logo = document.getElementById( "logo" );			
			var score = document.getElementById( "score" );
			var net = document.getElementById(  "net" );	
			
			var velocityX = ( Math.random() < 0.5 ? -1 : 1 ) * Math.floor( ( Math.random( ) * 8 ) + 5 );
			var velocityY = ( Math.random() < 0.5 ? -1 : 1 ) * Math.floor( ( Math.random( ) * 8 ) + 5 );			
	
			var ballMoving = 0;
			var ballOFBYPos = 0;
			var ballOFBXPos = 0;
			var resetting = 0;
			
			var match = 1;
			var passLeft   = 0;
			var passRight  = 0;
			
			var timer = 0;			
			var fps = 60;		
			
			var pad1  = document.getElementById( "pad1" );
			var pad11 = document.getElementById( "pad11" );
			var pad12 = document.getElementById( "pad12" );
			var pad2  = document.getElementById( "pad2" );
			var pad21 = document.getElementById( "pad21" );
			var pad22 = document.getElementById( "pad22" );			
			var ball  = document.getElementById( "ball" );
			
			lettier.style.left = ( wwidth / 2 - 400 ) + "px";
			lettier.style.top  = ( wheight / 2 - 400 ) + "px";
			
			score.style.left = ( wwidth / 2 - 300 ) + "px";
			score.style.top = ( wheight / 2 - 75 ) + "px";
			
			logo.style.left = ( wwidth / 2 - 250 ) + "px";
			logo.style.top  = ( wheight / 2 - 80 ) + "px";
			
			pad1.style.top = ( wheight/2 - 50 ) + "px";
			pad1.style.left = 25 + "px";
			pad1.style.height = 100 + "px";
			
			pad11.style.top = ( wheight - 50 ) + "px";
			pad11.style.left = ( (wwidth/2)/2 - 50 ) + "px";
			pad11.style.height = 25 + "px";
			pad11.style.width = 100 + "px";
			
			pad12.style.top = ( 25 ) + "px";
			pad12.style.left = ( (wwidth/2)/2 - 50 ) + "px";
			pad12.style.height = 25 + "px";
			pad12.style.width = 100 + "px";
			
			pad2.style.top =  ( wheight / 2 - 50 ) + "px";
			pad2.style.left = ( wwidth - 50 ) + "px";
			pad2.style.height = 100 + "px";
			
			pad21.style.top = ( wheight - 50 ) + "px";
			pad21.style.left = ( ( ( wwidth / 2 ) + ( ( wwidth / 2 ) / 2 ) ) - 50 ) + "px";
			pad21.style.height = 25 + "px";
			pad21.style.width = 100 + "px";
			
			pad22.style.top = ( 25 ) + "px";
			pad22.style.left = ( ( ( wwidth / 2 ) + ( ( wwidth / 2 ) / 2 ) ) - 50 ) + "px";
			pad22.style.height = 25 + "px";
			pad22.style.width = 100 + "px";
			
			net.style.left = ( wwidth / 2 ) + "px";
			net.style.height = wheight + "px";
			
			ball.style.left = (  wwidth / 2 - ( 25 / 2 ) ) + "px";
			ball.style.top  = ( wheight / 2 - 78 ) + "px";
			
			var ballXHome = Math.floor( (  wwidth / 2 - ( 25 / 2 ) ) );
			var ballYHome = Math.floor( ( wheight / 2 - 78 ) );			
			
			document.onmousemove = moveplayerpads;
			
			document.onkeyup = handlekey;
			
			function handlekey( kevent )
			{
				var key = ( window.event ) ? event.keyCode : kevent.keyCode;
				
				//debug.innerHTML = key +"";
				
				switch ( key )
				{
					case 82: 
						reset( );
						break;
					case 66:
						pad1.style.height = 200 + "px";
						break;
					case 86:
						velocityX = velocityX * 3;
						break;
				}
			}
			
			function moveplayerpads( mevent )
			{
				mevent = ( window.event ) ? window.event : mevent;
				pad1.style.top = ( mevent.clientY - 50 ) + "px";
				pad11.style.left = ( mevent.clientX - 50 ) + "px";
				pad12.style.left = ( mevent.clientX - 50 ) + "px";
				
				if ( ( parseInt( pad1.style.top, 10 ) + parseInt( pad1.style.height, 10 ) )  > ( wheight - 50 ) )
				{
					 pad1.style.top = ( ( wheight - 50 ) - parseInt( pad1.style.height, 10 ) ) + "px";
				}
				else if ( ( parseInt( pad1.style.top, 10 ) )  < 50 )
				{
					pad1.style.top = ( 50 ) + "px";
				}
				 
				if ( ( parseInt( pad11.style.left, 10 ) + parseInt( pad11.style.width, 10 ) )  > ( wwidth / 2 ) )
				{
					 pad11.style.left = ( ( wwidth / 2 ) - parseInt( pad11.style.width, 10 ) ) + "px";
					 pad12.style.left = ( ( wwidth / 2 ) - parseInt( pad12.style.width, 10 ) ) + "px";
				}
				else if ( ( parseInt( pad11.style.left, 10 ) )  < 50 )
				{
					pad11.style.left = ( 50 ) + "px";
					pad12.style.left = ( 50 ) + "px";
				}				
				
			}
			
			function movecomppads( stupidity )
			{
				var ballTop   = parseInt(  ball.style.top, 10 );
				var ballLeft  = parseInt(  ball.style.left, 10 );				
				var pad2Top   = parseInt(  pad2.style.top, 10 );
				var pad21Left = parseInt( pad21.style.left, 10 );
				
				if ( stupidity == 0 ) { stupidity = 1; }
				if ( stupidity < 0 )  { stupidity = 1; }
				
				if ( velocityX >=0 || ( ( velocityX < 0 ) && ( ballLeft > ( wwidth / 2 ) ) ) )
				{
					var diff = ballTop - pad2Top;

					if ( diff < 0 ) { pad2.style.top = ( pad2Top + ( diff / stupidity ) ) + "px"; }
					else if ( diff > 0 ) { pad2.style.top = ( pad2Top + ( diff / stupidity )  ) + "px"; }
					else { }
					
					diff = ballLeft - pad21Left;
					
					if ( diff < 0 ) { pad21.style.left = ( pad21Left + ( diff / stupidity ) ) + "px"; pad22.style.left = ( pad21Left + ( diff / stupidity ) ) + "px";  }
					else if ( diff > 0 ) { pad21.style.left = ( pad21Left + ( diff / stupidity )  ) + "px"; pad22.style.left = ( pad21Left + ( diff / stupidity )  ) + "px"; }
					else { }
					
					if ( ( parseInt( pad2.style.top, 10 ) + 100 )  > ( wheight - 50 ) )
					{
						 pad2.style.top = ( wheight - 150 ) + "px";
					}
					else if ( ( parseInt( pad2.style.top, 10 ) )  < 50 )
					{
						pad2.style.top = ( 50 ) + "px";
					}
					
					if ( parseInt( pad21.style.left, 10 ) < ( wwidth / 2 ) )
					{
						 pad21.style.left = ( wwidth / 2 ) + "px";
						 pad22.style.left = ( wwidth / 2 ) + "px";
					}
					else if ( ( parseInt( pad21.style.left, 10 ) + parseInt( pad21.style.width, 10 ) ) >= ( wwidth - 50 ) )
					{
						pad21.style.left = ( ( wwidth - 50 ) - parseInt( pad21.style.width, 10 ) ) + "px";
						pad22.style.left = ( ( wwidth - 50 ) - parseInt( pad22.style.width, 10 ) ) + "px";
					}
				}			
			}
			
			function updateScore( )
			{
				score.innerHTML = "<div id='play1' style='float:left'>" + passLeft + "</div> <div id='play2' style='float:right'>" + passRight + "</div>";
			}
			
			function returnHome( )
			{
				var bT = parseInt( ball.style.top, 10 );
				var bL = parseInt( ball.style.left, 10 );

				if ( ( bT != ballYHome ) || ( bL != ballXHome ) ) 
				{
					ball.style.backgroundColor="#555555"; 
					timer = setTimeout( function() {
						requestAnimationFrame( returnHome );
						if ( bT != ballYHome)
						{
							var move = bT + ( ( ballOFBYPos < ballYHome ) ? 10 : -10 );
							if ( Math.abs( bT - ballYHome ) < 10 )
							{
								move = bT + ( ( ballOFBYPos < ballYHome ) ? Math.abs( bT - ballYHome ) : -Math.abs( bT - ballYHome ) );
							}
							ball.style.top = ( move ) + "px";
						}
						
						if ( bL != ballXHome )
						{
							var move = bL + ( ( ballOFBXPos < ballXHome ) ? 10 : -10 );
							if ( Math.abs( bL - ballXHome ) < 10 )
							{
								move = bL + ( ( ballOFBXPos < ballXHome ) ? Math.abs( bL - ballXHome ) : -Math.abs( bL - ballXHome ) );
							}
							ball.style.left = ( move ) + "px";
						}
					}, 1000 / fps );					
				}
				else
				{
					ball.style.backgroundColor = "#ffffb2";
					ball.style.left = (  wwidth / 2 - ( 25 / 2 ) ) + "px";
					ball.style.top  = ( wheight / 2 - 78 ) + "px";
					clearTimeout( timer );
					resetting = 0;
				}
			}
			
			
			function reset( )
			{
				resetting = 1; 
				
				ballOFBYPos = parseInt( ball.style.top, 10 );
				ballOFBXPos = parseInt( ball.style.left, 10 );				
				
				returnHome( );
				
				match = match + 1;
				
				pad1.style.height = 100 + "px";
				pad11.style.width = 100 + "px";
				pad12.style.width = 100 + "px";
				
				pad2.style.height = 100 + "px";
				pad21.style.width = 100 + "px";
				pad22.style.width = 100 + "px";
				
				velocityX = ( Math.random() < 0.5 ? -1 : 1 ) * Math.floor( ( Math.random( ) * 8 ) + 5 );
				velocityY = ( Math.random() < 0.5 ? -1 : 1 ) * Math.floor( ( Math.random( ) * 8 ) + 5 );			
			}
			
			function checkCollisions( )
			{
				
				var ballLeft = parseInt( ball.style.left, 10 );
				var ballRight = parseInt( ball.style.left, 10 ) + 25;
				var ballTop = parseInt( ball.style.top, 10 );
				var ballBottom = parseInt( ball.style.top, 10 ) + 25;
				
				var pad1Left = parseInt( pad1.style.left, 10 );
				var pad1Right = parseInt( pad1.style.left, 10 ) + 25;
				var pad1Top = parseInt( pad1.style.top, 10 ) - 20;
				var pad1Bottom = parseInt( pad1.style.top, 10 ) + parseInt( pad1.style.height, 10 ) + 20;
				
				var pad11Left = parseInt( pad11.style.left, 10 ) - 20;
				var pad11Right = parseInt( pad11.style.left, 10 ) + 120; // Extra 20 for rounded corner padding
				var pad11Top = parseInt( pad11.style.top, 10 );
				var pad11Bottom = parseInt( pad11.style.top, 10 ) + parseInt( pad11.style.height, 10 );
				
				var pad12Left = parseInt( pad12.style.left, 10 ) - 20;
				var pad12Right = parseInt( pad12.style.left, 10 ) + 120; // Extra 20 for rounded corner padding
				var pad12Top = parseInt( pad12.style.top, 10 );
				var pad12Bottom = parseInt( pad12.style.top, 10 ) + parseInt( pad12.style.height, 10 );
				
				var pad2Left = parseInt( pad2.style.left, 10 );
				var pad2Right = parseInt( pad2.style.left, 10 ) + 25;
				var pad2Top = parseInt( pad2.style.top, 10 ) - 20;
				var pad2Bottom = parseInt( pad2.style.top, 10 ) + 120;
				
				var pad21Left = parseInt( pad21.style.left, 10 ) - 20;
				var pad21Right = parseInt( pad21.style.left, 10 ) + 120; // Extra 20 for rounded corner padding
				var pad21Top = parseInt( pad21.style.top, 10 );
				var pad21Bottom = parseInt( pad21.style.top, 10 ) + parseInt( pad21.style.height, 10 );
				
				var pad22Left = parseInt( pad22.style.left, 10 ) - 20;
				var pad22Right = parseInt( pad22.style.left, 10 ) + 120; // Extra 20 for rounded corner padding
				var pad22Top = parseInt( pad22.style.top, 10 );
				var pad22Bottom = parseInt( pad22.style.top, 10 ) + parseInt( pad22.style.height, 10 );
				
				if ( ( ballRight >= wwidth ) || ( ( ballTop <= 0 ) && ( ballLeft > ( wwidth / 2 ) ) ) || ( ( ballBottom >= wheight ) && ( ballLeft > ( wwidth / 2 ) ) ) )
				{
					passLeft += 1;
					updateScore( );
					reset( );
					
					return;
				}
				
				if ( ( ballLeft <= 0 ) || ( ( ballTop <= 0 ) && ( ballLeft <= ( wwidth / 2 ) ) ) || ( ( ballBottom >= wheight ) && ( ballLeft <= ( wwidth / 2 ) ) ) )
				{
					passRight += 1;
					updateScore( );
					reset( );
					
					return;
				}
				
				// COLLISION WITH THE LEFT AND RIGHT PADDLES
				
				if ( ( velocityX < 0 ) && ( ballLeft <= pad1Right ) && ( ballTop >= pad1Top ) && ( ballBottom <= pad1Bottom ) )
				{
					ball.style.left = ( ballLeft + 10 ) + "px";
					velocityX = velocityX * 1.2;
					velocityX = velocityX * -1;
					pad1.style.height = ( parseInt( pad1.style.height, 10 ) - 10 ) + "px";					
					
				}				
				
				if ( ( velocityX >= 0 ) && ( ballRight >= pad2Left ) && ( ballTop >= pad2Top ) && ( ballBottom <= pad2Bottom ) )
				{
					ball.style.left = ( ballLeft - 10 ) + "px";
					velocityX = velocityX * 1.2;
					velocityX = velocityX * -1;
					pad2.style.height = ( parseInt( pad2.style.height, 10 ) - 10 ) + "px";
				} 
				
				// COLLISION WITH THE UPPER AND LOWER PADDLES			
				
				if ( ( ballLeft <= ( wwidth / 2 ) ) && ( ballLeft >= pad11Left ) && ( ballRight <= pad11Right ) )
				{
					if ( ( ballBottom >= pad11Top ) ) // Player's bottom paddle.
					{
						ball.style.top = ( ballTop - 10 ) + "px";
						velocityY = velocityY * 1.2;
						velocityY = velocityY * -1;
						pad11.style.width = ( parseInt( pad11.style.width, 10 ) - 10 ) + "px";
					}
					else if ( ( ballTop <= pad12Bottom ) ) // Player's top paddle.
					{
						ball.style.top = ( ballTop + 10 ) + "px";
						velocityY = velocityY * 1.2;
						velocityY = velocityY * -1;
						pad12.style.width = ( parseInt( pad12.style.width, 10 ) - 10 ) + "px";
					}
				}				
				
				if ( ( ballLeft > ( wwidth / 2 ) ) && ( ballLeft >= pad21Left ) && ( ballRight <= pad21Right ) )
				{
					if ( ( ballBottom >= pad21Top ) ) // Computer's bottom paddle.
					{
						ball.style.top = ( ballTop - 10 ) + "px";
						velocityY = velocityY * 1.2;
						velocityY = velocityY * -1;
						pad21.style.width = ( parseInt( pad21.style.width, 10 ) - 10 ) + "px";
					}
					else if ( ( ballTop <= pad22Bottom ) ) // Computer's top paddle.
					{
						ball.style.top = ( ballTop + 10 ) + "px";
						velocityY = velocityY * 1.2;
						velocityY = velocityY * -1;
						pad22.style.width = ( parseInt( pad22.style.width, 10 ) - 10 ) + "px";
					}
				}
			}
			
			function ballmove( )
			{
				ballMoving = 1;
				var ballY = ( parseInt( ball.style.top, 10 ) );
				var ballX = ( parseInt( ball.style.left, 10 ) );
				ball.style.top  = ( velocityY + ballY ) + "px";
				ball.style.left = ( velocityX + ballX ) + "px";
				checkCollisions( );				
			}

			function draw() 
			{
				drawTimer = setTimeout( function() {
					requestAnimationFrame( draw );
					if ( !resetting )
					{
						ballmove( );
						movecomppads( 3 );
					}					
				}, 1000 / fps);
			}
			
			// alert( "Match: " + match );
			draw( );
					
		</script>
	</body>
</html>
